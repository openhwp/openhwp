# 한글 문서 파일 형식 3.0 / HWPML

> Hwp Document File Formats - Part I (HWPML)  
> Revision: 1.2 (2014-11-05)  
> 원문: 한글 문서 파일 형식 3.0 / HWPML  
> 범위: Part I - 한글 3.x 문서 파일 구조

## 차례

- [1. 한글 3.x 문서 파일 구조](#1-한글-3x-문서-파일-구조)
- [변경 사항 이력](#변경-사항-이력)
- [발행 정보](#발행-정보)

## 1. 한글 3.x 문서 파일 구조
(Hwp Document File Format 3.x)

### 1. 개요

한글의 문서 파일은 사용자가 따로 지정하지 않는 한 HWP를 기본 확장자로 가진다. 문서 파일에 저장되는 내용은, 실제 사용자가 입력한 문서의 내용과 문자 장식 정보뿐만 아니라 문서를 편집할 당시의 글꼴에 대한 정보, 조판에 영향을 주는 설정 사항(용지 종류, 여백 정보 등)도 포함된다.

한글 문서 파일 형식 3.x에는 이전 버전과는 달리, 단과 페이지의 구분에 대한 정보가 저장된다. 그러나 이 정보는 한글 97에서 저장된 문서가 아닌 경우 존재하지 않을 수 있으므로 부가적인 '힌트'의 의미로 사용되어야 하며, 이에 전적으로 의존해서는 안 된다. 완전하고 안전한 페이지 구분은 문서 파일을 읽은 쪽에서 페이지 정리(pagination)를 통해 재구성해야 한다.

한글의 문서 파일은 전체 파일 내용을 순차적으로 한번 읽는 것만으로 해석이 가능하다. 따라서 파일에 대한 비순차적인 접근(random access)은 굳이 필요하지 않다.

한글은 문서 파일의 압축 기능을 지원한다. 압축된 문서 파일도 기본적인 정보를 저장하는 앞부분은 압축되지 않으며, 실제 압축되는 부분은 사용자가 입력한 데이터 부분이다.

한글은 문서 파일의 압축에 FSF(Free Software Foundation)의 gzip을 사용했다. gzip은 범용 압축 프로그램으로서, FSF의 다른 소프트웨어와 마찬가지로, FSF에서 정한 GNU General Public License를 지키면 실행 프로그램과 소스 리스트를 사용 및 변형할 수 있다. 자세한 것은 gzip에 포함되어 있는 문서 파일을 참조하기 바란다.

한글에서는 압축되는 부분 전체가 하나의 스트림(stream)으로 압축되므로, 압축된 파일을 읽는 가장 손쉬운 방법은 일단 임시 파일로 압축을 푼 다음 그 파일을 대상으로 압축되지 않은 파일과 동일한 처리 과정을 거치면 된다.

한글 문서 파일 형식 3.x은 한글 윈도우즈/도스 3.0 버전의 구조를 기본으로 확장되었다. 한글 3.0 이후에 변경된 내용은 미리 준비된 예약 영역을 이용했기 때문에, 한글 97에서 저장된 문서 파일은 추가된 정보의 일부 손실을 제외하면 한글 3.0 이후 버전에서 별도의 변환 과정 없이 읽을 수 있다.

### 2. 자료형 설명

앞으로 계속되는 설명에서 한글의 문서 파일에 저장되는 정보는 아래 표에 설명하는 자료형을 이용해 표현한다.

자료형에서 한 바이트는 8비트로 표현되며, 두 바이트 이상의 길이를 가지는 자료형은 최하위 바이트가 가장 먼저 저장되고, 최상위 바이트가 가장 나중에 저장되는 리틀 인디언(little indian) 형태이다.

파일에 저장되는 자료가 배열(array)일 때는 '자료형 array[개수]'와 같이 표현한다. 예를 들어 10개의 원소를 갖는 word 배열이면 'word array[10]'과 같이 표현한다.

#### 표 1. 설명에 사용된 자료형

| 자료형 | 길이 | 부호 | 설명 |
|--------|------|------|------|
| byte | 1 | | 부호 없는 한 바이트 (0 - 255) |
| sbyte | 1 | √ | 부호 있는 한 바이트 (-128 - 127) |
| word | 2 | | 16비트 컴파일러에서 'unsigned int'에 해당 |
| sword | 2 | √ | 16비트 컴파일러에서 'int'에 해당 |
| dword | 4 | | 16비트 컴파일러에서 'unsigned long'에 해당 |
| sdword | 4 | √ | 16비트 컴파일러에서 'long'에 해당 |
| hchar | 2 | | 한글의 내부 코드로 표현된 문자 |
| echar | 1 | | 영문만을 표현하기 위한 문자형 (0-127) |
| kchar | 1 | | 상용조합형 한글까지 표현할 수 있는 문자형 (0-255) |
| hunit | 2 | | 1/1800인치로 표현된 한글 내부 단위 (0 - 65535) |
| shunit | 2 | √ | 1/1800인치로 표현된 한글 내부 단위 (-32768 - 32767) |
| hunit32 | 4 | | 32비트로 표현된 hunit |
| shunit32 | 4 | √ | 32비트로 표현된 shunit |

**hchar**는 한글의 내부 코드로 표현된 문자 한 글자를 표현하는 자료형이다. 한글의 내부 코드는 한글, 영문, 한자를 비롯해 모든 문자가 2바이트의 일정한 길이를 가진다. 한글의 내부 코드에 대한 자세한 사항은 한글 설명서를 참조하기 바란다.

**echar**와 **kchar**는 표준 C의 자료형인 char와 같은 의미로 생각하면 되는데, 차이점은 echar는 영문 아스키 코드(0-127)만을 표현하고, kchar는 상용조합형 한글도 표현할 수 있다는 점이다. 예를 들어 문서 파일에 저장되는 글꼴 이름을 설명하는 곳에서 'kchar array[40]'로 나타나 있는데, 이것은 상용조합형 한글이 포함될 수 있는 최대 길이 40바이트의 문자열이라는 뜻이다.

**hunit**과 **shunit**는 문자의 크기, 그림의 크기, 용지 여백 등, 문서를 구성하는 요소들의 크기를 표현하기 위한 자료형이다. 문서 출력 장치의 해상도는 가변적이기 때문에, 크기 정보를 점(도트)의 수로 표현할 수는 없고 일정한 단위를 기준으로 해야 하는데, 한글에서는 1/1800인치를 기본 단위로 사용한다. 예를 들어 가로 2인치 세로 1인치짜리 그림의 크기를 hunit 형으로 표현하면 각각 3600, 1800이 된다.

### 3. 전체 구조

한글의 문서 파일은 개괄적으로 다음 표와 같은 구조를 가진다.

#### 표 2. 한글 문서 파일의 전체 구조

| 설명 | 길이 (바이트) | 압축 |
|------|---------------|------|
| 파일 인식 정보 | 30 | |
| 문서 정보 | 128 | |
| 문서 요약 | 1008 | |
| 정보 블록 (#0) | 가변 | |
| 글꼴 이름 | 가변 | √ |
| 스타일 | 가변 | √ |
| 문단 리스트 | 가변 | √ |
| 추가 정보 블록 (#1) | 가변 | √ |
| 추가 정보 블록 (#2) | 가변 | |

압축된 문서 파일의 경우 '글꼴 이름'부터 '추가 정보 블록'까지의 자료가 하나의 압축된 스트림(stream)으로 저장되므로, 문서 파일을 읽는 쪽에서는 '문서 정보' 항목의 '압축' 플래그를 살펴보고 압축된 파일이면 압축을 풀어서 처리해야 한다. 이후의 설명에서는 압축이 풀린 상태의 파일을 기준으로 한다.

#### 3.1. 파일 인식 정보

한글의 문서 파일이라는 것을 나타내기 위해 파일의 가장 첫 부분 30바이트는 인식 정보가 저장된다. 이 정보는 다음과 같은 내용을 가진다.

- **문자열**: `"HWP Document File V3.00 \x1a\1\2\3\4\5"`
- **덤프**: `48 57 50 20 44 6F 63 75 6D 65 6E 74 20 46 69 6C 65 20 56 33 2E 30 30 20 1A 01 02 03 04 05`

#### 3.2. 문서 정보

#### 표 3. 문서 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | word | 커서 줄 | 문서를 저장할 당시 커서가 위치한 문단 번호 |
| 2 | word | 커서 칸 | 문서를 저장할 당시 커서가 위치한 문단 칸 |
| 4 | byte | 용지 종류 | * 용지 종류 표 참조 |
| 5 | byte | 용지 방향 | 0 = 보통, 1 = 넓게 |
| 6 | hunit | 용지 길이 | |
| 8 | hunit | 용지 너비 | |
| 10 | hunit | 위쪽 여백 | 편집 용지 정보 |
| 12 | hunit | 아래쪽 여백 | |
| 14 | hunit | 왼쪽 여백 | |
| 16 | hunit | 오른쪽 여백 | |
| 18 | hunit | 머리말 길이 | |
| 20 | hunit | 꼬리말 길이 | |
| 22 | hunit | 제본 여백 | |
| 24 | dword | 문서 보호 | 1 = 보호된 문서 (편집 불가), 0 = 일반 문서 |
| 28 | word | 예약 | 1 = HWP 외부에서 만들어진 문서(컨버터가 만든 문서), bit 처리, 외부문서의 경우 realign. |
| 30 | byte | 쪽번호 연결 | 1 = 연결, 0 = 새로 시작 (연결 인쇄에서 사용됨) |
| 31 | byte | 각주번호 연결 | 1 = 연결, 0 = 새로 시작 (연결 인쇄에서 사용됨) |
| 32 | kchar array[40] | 연결 인쇄 파일 | 연결 인쇄할 파일의 이름 |
| 72 | kchar array[24] | 덧붙이는 말 | 문서 파일에 대한 부가 설명 |
| 96 | word | 암호 여부 | 0 = 보통 파일, 이외 = 암호 걸린 파일 |
| 98 | word | 시작페이지 번호 | |
| 100 | word array[2] | 각주 옵션 | 각주시작번호, 예약(각주개수) |
| 104 | hunit | 각주 옵션 | 각주 분리선과 본문 사이의 간격 |
| 106 | hunit | 각주 옵션 | 각주와 본문 사이의 간격 |
| 108 | hunit | 각주 옵션 | 각주와 각주 사이의 간격 |
| 110 | echar | 각주 옵션 | ')' = 각주 번호에 ')'를 붙임, 0=안 붙임 |
| 111 | byte | 각주 옵션 | 각주 분리선 너비. 0=5cm, 1=본문의 1/3, 2=단너비, 3=없음 |
| 112 | hunit array[4] | 테두리 간격 | 쪽 테두리와 본문 간격 (왼쪽,오른쪽,위,아래) |
| 120 | word | 테두리 종류 | 쪽 테두리 선의 종류. 0 = 없음, 이외 = 종류 |
| 122 | byte | 빈줄감춤 | 0 이외 = on |
| 123 | byte | 틀옮김 | 0 이외 = on |
| 124 | byte | 압축 | 0 = 압축되지 않은 파일, 이외 = 압축된 파일 |
| 125 | byte | sub revision | 언제나 1 (0은 한글3.0에서 만든파일) |
| 126 | word | 정보 블록 길이 | 정보 블록의 길이 (바이트 단위) |
| | | **전체 길이** | **128** |

#### 표 4. 용지 종류

| 번호 | 종류 |
|------|------|
| 0 | 사용자 정의 |
| 1 | 프린트 80 |
| 2 | 프린트 132 |
| 3 | A4 |
| 4 | 레터 |
| 5 | B5 |
| 6 | B4 |
| 7 | 리갈 |
| 8 | A3 |

#### 3.3. 문서 요약

한글 메뉴의 문서-문서정보-문서요약에서 입력한 내용이 저장된다.

#### 표 5. 문서 요약

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | hchar array[56] | 112 | 제목 |
| 112 | hchar array[56] | 112 | 주제 |
| 224 | hchar array[56] | 112 | 지은이 |
| 336 | hchar array[56] | 112 | 날짜 |
| 448 | hchar array[2][56] | 112×2 | 키워드 |
| 672 | hchar array[3][56] | 112×3 | 기타 |
| | | **전체 길이** | **1008** |

#### 3.4. 정보 블록

정보 블록은 아래와 같은 구조의 자료가 필요한 만큼 연속된다.

**정보 블록**: `ID (2 바이트) → 길이 (2 바이트) → 내용 (n 바이트)`

#### 표 6. 정보 블록

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | word | 2 | 정보 블록 ID |
| 2 | word | 2 | 정보 블록의 길이 (n) |
| 4 | byte array[n] | n | 정보 블록 내용 |
| | | **전체 길이** | **가변 4 + n 바이트** |

정보 블록은 아예 존재하지 않거나, 여러 개의 정보 블록이 연속해 존재할 수 있다. 정보 블록 전체의 길이는 문서 정보의 '정보 블록 길이' 항목에 바이트 단위로 저장된다.

정보 블록은 파일의 앞 부분 고정된 위치에 저장되며, 압축에서 제외되는 영역이기 때문에 파일 전체를 읽지 않고도 쉽게 읽어낼 필요가 있는 정보를 저장하는 목적으로 사용된다.

한글에서 정보 블록에 저장하는 내용은 [책갈피]와 [상호참조]가 있다. 더 자세한 내용은 '정보 블록 자료 구조'를 참조하기 바란다.

#### 3.5. 글꼴 이름

한글 문서 파일에는 문서를 편집할 당시의 시스템에 등록되어 있는 글꼴의 이름들이 함께 저장된다. 문서 중간의 글자 모양에서 특정한 글꼴을 참조할 때는 글꼴 이름의 인덱스(index)를 이용한다.

글꼴 이름은 처음 word 형으로 글꼴 이름의 개수가 나오며, 그 개수만큼 kchar 형으로 40바이트 길이의 문자열이 반복된다. 이러한 형태가 각 언어별로 7번 반복되면 글꼴 이름 정보가 끝난다.

- **한글**: `word nfonts, kchar fontnames[nfonts][40];`
- **영문**: `word nfonts, kchar fontnames[nfonts][40];`
- **한자**: `word nfonts, kchar fontnames[nfonts][40];`
- **일어**: `word nfonts, kchar fontnames[nfonts][40];`
- **기타**: `word nfonts, kchar fontnames[nfonts][40];`
- **기호**: `word nfonts, kchar fontnames[nfonts][40];`
- **사용자**: `word nfonts, kchar fontnames[nfonts][40];`

#### 3.6. 스타일

한글 문서 파일에는 사용자가 정의한 스타일 정보가 함께 저장된다. 처음 word 형으로 스타일의 개수가 나오며, 개수만큼 스타일 정보가 반복된다.

**스타일**: `word nstyles, { 스타일 정보 }×nstyles`

#### 표 7. 스타일 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | kchar array[20] | 20 | 스타일 이름 |
| 20 | {글자 모양} | 31 | '글자 모양 자료 구조' 참조 |
| 51 | {문단 모양} | 187 | '문단 모양 자료 구조' 참조 |
| | | **전체 길이** | **238** |

#### 3.7. 문단 리스트

스타일 정보가 끝나면 사용자가 입력한 문단의 내용이 저장된다. 문단들은 사용자가 입력한 순서대로 저장된다. 문단 리스트는 이처럼 순서대로 저장된 일련의 문단들을 뜻한다.

한글에서 모든 문단의 끝은 hchar로 표현된 특수 문자 13번(CR)으로 끝난다. 따라서 문단의 길이는 적어도 1 이상이 되는데, 문단의 길이가 0인 문단은 빈(null) 문단으로서, 문단 리스트의 끝을 나타내기 위해 사용된다.

표 등이 없는 단순한 문서 파일의 경우, 문단 리스트는 하나만 존재하지만, 표 등을 사용했을 때는 표의 각 셀이 하나씩의 문단 리스트를 가지게 되므로, 이러한 문서 파일에서는 중첩된 여러 개의 문단 리스트가 저장된다. 다음 예제를 참조하기 바란다.

**문서 1**
```
첫 번째 문단
두 번째 문단
세 번째 문단
```

**문서 1의 문단 리스트 구조**
```
{문단 리스트 시작}
  첫 번째 문단 → 두 번째 문단 → 세 번째 문단 → 빈 문단
{문단 리스트 끝}
```

**문서 2**
```
첫 번째 문단
두 번째 문단
┌─────┬─────┐
│셀1  │셀2  │
│     │     │
│셀1의│셀2의│
│문단 │문단 │
├─────┼─────┤
│셀3  │셀4  │
│     │     │
│셀3의│셀4의│
│문단 │문단 │
└─────┴─────┘
세 번째 문단
```

**문서 2의 문단 리스트 구조**
```
{문단 리스트 시작}
  첫 번째 문단 → 두 번째
  {표 시작}
    {문단 리스트 시작} 셀1 → 셀1의 문단 → 빈 문단 {문단 리스트 끝}
    {문단 리스트 시작} 셀2 → 셀2의 문단 → 빈 문단 {문단 리스트 끝}
    {문단 리스트 시작} 셀3 → 셀3의 문단 → 빈 문단 {문단 리스트 끝}
    {문단 리스트 시작} 셀4 → 셀4의 문단 → 빈 문단 {문단 리스트 끝}
  {표 끝}
  문단 → 세 번째 문단 → 빈 문단
{문단 리스트 끝}
```

#### 3.8. 추가 정보 블록

추가 정보 블록은 부가적인 정보를 저장하기 위해 사용되며, 압축되는 영역이다. 아래와 같은 구조의 자료가 필요한만큼 연속된다.

**추가 정보 블록**: `ID (4 바이트) → 길이(4 바이트) → 내용 (n 바이트)`

#### 표 8. 추가 정보 블록

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 추가 정보 블록 ID |
| 4 | dword | 4 | 추가 정보 블록의 길이 (n) |
| 8 | byte array[n] | n | 추가 정보 블록 내용 |
| | | **전체 길이** | **가변 8 + n 바이트** |

추가 정보 블록은 아예 존재하지 않거나, 여러 개의 추가 정보 블록이 연속해 존재할 수 있다. 추가 정보 블록이 존재할 경우, 가장 마지막 추가 정보 블록은 8바이트의 연속된 0으로 나타낸다.

한글에서 추가 정보 블록에 저장하는 내용은 OLE, 파일에 포함된 그림(embedded image), 하이퍼텍스트, 프리젠테이션 설정 정보가 있다. 더 자세한 내용은 '추가 정보 블록 자료 구조'를 참조하기 바란다.

#### 3.9. 추가 정보 블록 #2

추가 정보 블록 #2는 한글 96에 추가된 영역이다. 부가적인 정보를 저장하기 위해 사용되며, 압축되지 않는 영역이다.

**추가 정보 블록 #2**: `ID (4 바이트) → 길이(4 바이트) → 내용 (n 바이트)`

#### 표 9. 추가 정보 블록 #2

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 추가 정보 블록 #2 ID |
| 4 | dword | 4 | 추가 정보 블록 #2의 길이 (n) |
| 8 | byte array[n] | n | 추가 정보 블록 #2 내용 |
| | | **전체 길이** | **가변 8 + n 바이트** |

추가 정보 블록 #2는 아예 존재하지 않거나, 여러 개의 추가 정보 블록 #2가 연속해 존재할 수 있다. 추가 정보 블록 #2가 존재할 경우, 마지막은 ID 0x80000000으로 표현한다. 따라서 다음과 같은 내용의 8 바이트 값으로 나타낸다. 마지막ID 뒤의 size가 0이 아닐 경우 비압축 영역의 크기를 나타낸다.

#### 표 10. 추가 정보 블록 ID 예

| 마지막 ID | SIZE |
|-----------|------|
| 0x00 0x00 0x00 0x80 | 0x00 0x00 0x00 0x00 |

한글에서 추가 정보 블록 #2에 저장하는 내용은 [문서 파일 미리 보기]에 관련된 정보이다. 더 자세한 내용은 '추가 정보 블록 #2 자료 구조'를 참조하기 바란다.

### 4. 문단 자료 구조

하나의 문단은 문단 전체에 대한 기본 속성을 나타내는 ① 문단 정보와, 문단 안의 각 줄에 대한 정보를 나타내는 ② 줄 정보, 문단 안의 각 글자들이 가지고 있는 ③ 글자 모양 정보, 문단의 내용인 ④ 글자들로 구성되어 있다.

#### 4.1. 문단 정보

#### 표 11. 문단 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte | 앞 문단 모양* | 0 = 새 문단 모양이 저장됨<br>이외 = 앞 문단 모양을 따라감 |
| 1 | word | 글자 수 | 0 = 빈 문단 (문단 리스트의 끝)<br>이외 = 문단 내용의 글자 수 (hchar 단위) |
| 3 | word | 줄 수 | 문단의 줄 수 |
| 5 | byte | 글자 모양 포함* | 0 = 모든 글자가 대표 글자 모양을 따라감<br>이외 = 각 글자에 대한 모양이 별도로 저장됨 |
| 6 | byte | 기타 플래그 | bit 0 = 단 나눔<br>bit 1 = 페이지 나눔<br>bit 2 = 조판 나눔<br>bit 3 = 블록 보호 시작<br>bit 4 = 블록 보호 중간<br>bit 5 = 블록 보호 끝<br>bit 6 = 외톨이줄 보호<br>bit 7 = 예약 |
| 7 | dword | 특수 문자 플래그 | 각 비트가 0-31 사이의 특수 문자 존재 여부를 표현 |
| 11 | byte | 스타일 | 문단의 스타일 인덱스 |
| 12 | {글자 모양} | 대표 글자 모양 | '글자 모양 포함*'이 0일 때 사용될 글자 모양 |
| 43 | {문단 모양} | 문단 모양 | '앞 문단 모양*'이 0일 때만 저장됨 |
| | | **전체 길이** | **가변 43 또는 230 바이트** |

문단 정보의 '앞 문단 모양' 항목이 0이 아닐 때는 문단 모양 정보가 따로 저장되지 않고 앞 문단의 모양을 따라간다. 일반적으로 한번 지정된 문단 모양은 좀처럼 바뀌지 않는다는 점을 감안해, 중복된 정보의 저장을 줄여 파일 크기를 줄이기 위한 방법이다. 문단 리스트의 첫 번째 문단은 앞 문단이 존재하지 않기 때문에, '앞 문단 모양' 항목이 늘 0이다.

비슷한 방식으로, 각 글자에 대한 모양도 문단 전체의 글자가 모두 동일한 모양일 때는 '대표 글자 모양' 항목에 글자 모양이 한 번만 저장되며, 각 글자에 대한 별도의 글자 모양 정보는 저장되지 않는다. 만약 '글자 모양 포함' 항목이 0이 아닐 때는 '대표 글자 모양' 항목이 문서 파일에 저장은 되지만 실제 사용되지는 않는다.

'문단 모양' 항목은 '앞 문단 모양' 항목이 0일 때만 저장되며, 이외의 경우에는 생략되므로, 한글 문서 파일을 읽는 쪽에서는 문단 정보를 읽을 때 반드시 '앞 문단 모양' 항목을 확인해야 한다. '문단 모양' 항목의 자료 구조는 '문단 모양 자료 구조'를 참조하기 바란다.

'스타일'은 그 문단이 어떤 스타일을 가리키고 있는지 나타낸다. 이 값은 문서 파일의 앞부분에 저장된 스타일 정보에 대한 인덱스이다.

#### 4.2. 줄 정보

아래 표와 같은 {줄 정보×줄 수}만큼 문단 내의 각 줄에 대한 정보가 저장된다.

#### 표 12. 줄 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | word | 줄의 시작 위치 | 문단 내용에서 줄이 시작하는 위치 (hchar 단위 오프셋) |
| 2 | hunit | 공백 보정값 | 보정을 위해 공백 문자의 폭에 더해줄 값 |
| 4 | hunit | 줄의 높이 | 줄에서 가장 큰 글자의 높이 |
| 6 | byte array[6] | 예약 | |
| 12 | word | 단/페이지 구분 | 이 줄이 단/페이지의 경계인지 여부<br>bit 0 = 페이지 경계<br>bit 1 = 단 경계<br>bit 2-14 = 예약<br>bit 15 = 1일 때만 단/페이지 구분 정보가 유효하다. |
| | | **전체 길이** | **14** |

#### 4.3. 글자 모양 정보

문단 내용의 글자 중에서 하나라도 다른 모양을 가진 것이 있으면, 모든 글자에 대한 글자 모양 정보가 저장된다. 그러나 이 경우에도 앞 글자와 동일한 모양을 가진 글자에 대해서는 앞 글자와 동일하다는 뜻의 1 바이트짜리 플래그 하나만 저장된다.

따라서 실제 문서 파일에 저장되는 글자 모양 정보는 다음과 같은 구조를 가진다.

`{ byte flag, {글자 모양} }×글자 수`

flag이 1이면 앞 글자 모양을 따라가며, 글자 모양은 저장되지 않는다. flag이 1 이외이면 뒤따라 글자 모양이 저장된다. 글자 모양의 자료 구조는 아래의 '글자 모양 자료 구조'를 참조하기 바란다.

#### 4.4. 글자들

글자 모양 정보에 이어서 실제 문단의 내용인 글자들이 저장된다. 각 글자는 hchar로 표현되며, 문단 정보의 '글자 수' 항목이 나타내는 개수만큼의 hchar 문자가 저장된다. 문단의 마지막 문자는 늘 hchar로 표현된 특수 문자 13번(CR)이다.

### 5. 문단 모양 자료 구조

#### 표 13. 문단 모양

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hunit | 왼쪽 여백 | |
| 2 | hunit | 오른쪽 여백 | |
| 4 | shunit | 들여 쓰기 | |
| 6 | hunit | 줄 간격 | MSB가 1이면 절대 간격, 이외는 퍼센트 단위 |
| 8 | hunit | 문단 아래 간격 | |
| 10 | byte | 낱말 간격 | 퍼센트 단위 |
| 11 | byte | 정렬 방식 | 0 - 7, 도스 버전의 '문단모양-정렬방식' 순서. |
| 12 | {탭 설정} array[40] | 탭 설정 | 최대 40개까지의 {탭 설정} 정보 (* 아래 설명 참조) |
| 172 | {단정의} | 단 정의 | 다단에 대한 정보 (** 아래 설명 참조) |
| 180 | byte | 음영 비율 | 문단 테두리 음영 비율, 퍼센트 단위 |
| 181 | byte | 문단 테두리 | 0 = 문단 테두리 없음, 1 = 문단 테두리 있음 |
| 182 | byte | 선 연결 | 0 = 위/아래 문단과 테두리 선 연결하지 않음<br>1 = 위/아래 문단과 테두리 선 연결 |
| 183 | hunit | 문단 위 간격 | |
| 185 | byte array[2] | 예약 | |
| | | **전체 길이** | **187** |

#### 표 14. 탭 설정

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte | 종류 | 0 ～ 3 (왼쪽, 오른쪽, 가운데, 소수점 탭) |
| 1 | byte | 점 끌기 여부 | |
| 2 | hunit | 탭 위치 | |
| | | **전체 길이** | **4** |

탭 설정이 하나라도 존재하면 기본 탭 정보는 설정되지 않는다.

#### 표 15. 단 정의

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte | 단 수 | |
| 1 | byte | 단 구분선 | 0-4. {조판,다단,단구분선, 메뉴 순서 (도스 버전 기준)} |
| 2 | hunit | 단 간격 | |
| 4 | byte array[4] | 예약 | |
| | | **전체 길이** | **8** |

### 6. 글자 모양 자료 구조

#### 표 16. 글자 모양

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hunit | 크기 | 글자의 크기 |
| 2 | byte array[7] | 글꼴 | 각 언어별 글꼴 인덱스(표 34 참조) |
| 9 | byte array[7] | 장평 | 각 언어별 장평 비율, 50% ～ 200%(표 34 참조) |
| 16 | sbyte array[7] | 자간 | 각 언어별 자간 비율, -50% ～ 50%(표 34 참조) |
| 23 | byte | 음영색 | 0 ～ 7, 메뉴 순서 대로 * |
| 24 | byte | 글자색 | 0 ～ 7, 메뉴 순서 대로 * |
| 25 | byte | 음영 비율 | 0% ～ 100% |
| 26 | byte | 속성 | bit 0 = 이탤릭<br>bit 1 = 진하게<br>bit 2 = 밑줄<br>bit 3 = 외곽선<br>bit 4 = 그림자<br>bit 5 = 위첨자<br>bit 6 = 아래첨자<br>bit 7 = 글꼴에 어울리는 빈 칸 |
| 27 | byte array[4] | 예약 | |
| | | **전체 길이** | **31** |

**글자색/음영색 순서**: { 검정=0, 파랑, 초록, 청록, 빨강, 자주, 노랑, 흰색=7 }

**Note**: Hwp2.0 Format은 Language type이 5개씩이어서 글자모양 Structure크기는 25byte였음.

### 7. 정보 블록 자료 구조(파일 앞 부분)

#### 7.1. 책갈피

정보 블록에는 문서에 존재하는 모든 책갈피의 리스트가 저장된다. (* 컨트롤 코드 0x6 참조)

#### 표 17. 책갈피 정보 블록

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | word | 2 | 1 = 책갈피 정보 블록 ID |
| 2 | word | 2 | 38 x n = 전체 책갈피의 길이 |
| 4 | hchar array[16] | 32 | 책갈피 이름 |
| 36 | word | 2 | 책갈피 종류 |
| 38 | dword | 4 | 예약 |
| | | **전체 길이** | **가변 4 + 38 x n 바이트** |

#### 7.2. 상호참조

정보 블록에는 문서에 존재하는 모든 상호참조의 리스트가 저장된다. (*컨트롤 코드 29 참조)

#### 표 18. 상호참조 정보 블록

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | word | 2 | 2 = 상호참조 정보 블록 ID |
| 2 | word | 2 | 45 x n = 전체상호참조 정보의 길이 |
| 4 | hchar array[37] | 74 | 상호참조 이름 |
| 78 | sdword | 4 | 예약 |
| 82 | sdword | 4 | 상호참조 종류 |
| | | **전체 길이** | **가변 4 + 45 x n 바이트** |

### 8. 추가 정보 블록 자료 구조 (파일의 끝 부분)

#### 8.1. 파일에 포함된 그림 정보

파일에 포함된 그림(embedded image)은 특수 문자의 그림 코드에는 이름만 존재하며, 실제 이미지 데이터는 추가 정보 블록에 저장된다. ( (ID 길이 데이타) x N )

#### 표 19. 파일에 포함된 그림 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 1 = 파일에 포함된 그림 정보 ID |
| 4 | dword | 4 | 32 + 그림 내용 길이 (n) |
| 8 | echar array[16] | 16 | 이름 |
| 24 | echar array[16] | 16 | 포맷 |
| 40 | byte array[n] | n | 그림 내용 |
| | | **전체 길이** | **가변 40 + n 바이트** |

#### 8.2. OLE 정보

문서에 존재하는 OLE 개체들은 특수 문자의 그림 코드에는 이름만 존재하며, 실제 데이터는 스토리지 파일(storage file) 형태로 추가 정보 블록에 저장된다. 자세한 것은 'OLE 개체 자료 구조'를 참조하기 바란다.

#### 표 20. OLE 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 2 = OLE 정보 ID |
| 4 | dword | 4 | OLE 정보 길이 (n) |
| 8 | byte array[n] | n | OLE 정보 내용 |
| | | **전체 길이** | **가변 8 + n 바이트** |

#### 8.3. 하이퍼텍스트(HyperLink) 정보

#### 표 21. 하이퍼텍스트 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 3 = 하이퍼텍스트 정보 ID |
| 4 | dword | 4 | 617 x n = 하이퍼텍스트 정보 길이 |
| 8 | kchar array[256] | | 건너뛴 파일 이름 (현재 파일의 책갈피라면 "\0") |
| 264 | hchar array[16] | | 건너뛴 책갈피 ('[문서의 처음]'은 실제 존재하지는 않지만, 사용되는 책갈피 이름) |
| 296 | byte array[325] | | 매크로 (도스용에서 실행할 매크로) |
| 621 | byte | | 종류 (0,1 = 한글, 2 = HTML/ETC) |
| 622 | byte array[3] | | 예약 |
| | | **전체 길이** | **가변 8 + 617 x n 바이트** |

본문에 포함된 텍스트 박스의 옵션(offset 14)에 하이퍼텍스트 여부(bit 4)가 켜져 있을 때, 텍스트 박스와 같은 순서로 하이퍼텍스트 정보(길이 = 617 x n)가 저장된다. 문서내에서는 책갈피(0x6)를 참조해서 Jump한다.

#### 8.4. 프리젠테이션 설정 정보

프리젠테이션 설정 정보는 앞 부분의 약간의 부가 정보를 제외하면, 그리기 개체의 속성 정보와 동일한 내용이 저장된다. 속성에 비트맵 패턴이 삽입 파일로 지정된 경우에는 실제 그림 파일의 내용이 연달아 저장된다. 따라서 속성에 따라 다음과 같은 두 가지 형식 중 하나로 저장된다.

- **형식 #1**: 프리젠테이션 설정 정보 (406 바이트)
- **형식 #2**: 프리젠테이션 설정 정보 (406 바이트) → 그림 파일 길이 (4 바이트) → 그림 파일 내용 (n 바이트)

#### 표 22. 프리젠테이션 설정 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 4 = 프리젠테이션 설정 정보 ID |
| 4 | dword | 4 | 398 + n = 프리젠테이션 설정 정보 길이 |
| 8 | sdword | 4 | 미리 정의된 set 번호, -1이면 사용자 정의 |
| 12 | hunit32 | 4 | 선 굵기 |
| 16 | dword | 4 | 선 색깔 (0 - 7, 글자 모양의 글자색 순서) |
| 20 | dword | 4 | bit 0 = 검은색 글자를 흰색으로 할 것인지 여부<br>bit 1-31 = 예약 |
| 24 | {기본 속성} | 44 | 그리기 개체의 '기본 속성' 설명 참조 |
| 68 | {회전 속성} | 32 | 그리기 개체의 '회전 속성' 설명 참조 |
| 100 | {그라데이션 속성} | 28 | 그리기 개체의 '그라데이션 속성' 설명 참조 |
| 128 | {비트맵 패턴 속성} | 278 | 그리기 개체의 '비트맵 패턴 속성' 설명 참조 |
| | | **전체 길이** | **406** |

#### 8.5. 예약 정보

#### 표 23. 예약 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 5 = 예약 정보 ID |
| | | **전체 길이** | **4** |

#### 8.6. 배경이미지 정보

#### 표 24. 배경이미지 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 6 = 배경이미지 정보 ID |
| 4 | dword | 4 | len = 크기 |
| 8 | dword | 4 | 1 = 무조건 |
| 12 | dword | 4 | Tag |
| 16 | dword | 4 | brightness (그림 밝기) |
| 20 | dword | 4 | contrast (그림 명암) |
| 24 | dword | 4 | effect (그림 효과) |
| 28 | dword | 4 | isPrint (프린트 시 반영할지) |
| 32 | char array[256] | 256 | picname (이미지 파일명) |
| 288 | dword | 4 | pictype (이미지 type: 2=삽입그림, 0=연결그림) |
| 292 | dword | 4 | color = 0x10000000 |
| 296 | dword | 4 | display option (0=바둑판, 1=가운데, 3=쪽 크기로) |
| 300 | dword | 4 | page option (0=양쪽, 4=홀수 쪽, 3=짝수 쪽) |
| 304 | dword array[2] | 8 | sx, sy |
| 312 | dword array[2] | 8 | width, height (가로세로 크기) |
| 320 | dword array[2] | 8 | reserved |
| 328 | dword | 4 | n = 삽입그림 크기 |
| 332 | byte | n | 삽입된 이미지 데이터 |
| | | **전체 길이** | **가변 332 + n 바이트** |

#### 8.7. 테이블 확장 (셀 필드 이름) 정보

#### 표 25. 테이블 셀에 대한 필드 이름 정보 리스트

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 0x100 = 테이블 셀에 대한 필드 이름 정보 ID |
| 4 | dword | 4 | n = 테이블 셀에 대한 필드 이름 정보 길이 |
| 8 | word | 2 | 셀의 갯수 |
| 10 | word | 2 | 테이블ID |
| 12 | dword | 4 | 필드 이름 리스트 길이 |
| 16 | byte array[n] | n | 테이블 셀에 대한 필드 이름 리스트 내용.<br>아래 필드 길이와 이름이 복수개 반복.(표 31 참조) |
| | | **전체 길이** | **가변 16 + n 바이트** |

#### 표 26. 테이블 셀에 대한 필드 이름 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | word | 2 | n' = 필드 이름 길이<br>(셀에 필드 이름이 없는 경우에는 0) |
| 2 | byte array[n'] | n' | 필드 이름 내용 |
| | | **전체 길이** | **가변 2 + n' 바이트** |

#### 8.8. 누름틀 필드 이름 정보

추가 정보 블록에 저장된 누름틀 필드 이름 리스트내의 각 필드 이름이 문단 내 어느 누름틀과 맵핑되는지는 누름틀 필드 이름 정보의 필드 번호와 누름틀의 바이너리 데이터(32바이트) 중 5,6번째 바이트를 이용한다.

누름틀의 바이너리 데이터 중 5,6번째 바이트 값은 필드 이름을 수정하거나 하면 새로운 값으로 대체되므로 연속된 순서값은 아니다. 그러나 문서를 마치고 새로 여는 경우에는 문서내 누름틀의 필드 번호를 1부터 끝번호까지 연속된 값으로 리셋된다.

누름틀 필드 번호와 필드 이름 길이는 각각 word이므로 문서내 삽입 가능한 누름틀 필드의 갯수 및 필드 이름의 길이는 최대 2의 16승이다.

#### 표 27. 누름틀 필드 이름 리스트 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 0x101 = 누름틀 필드 이름 정보 ID |
| 4 | dword | 4 | n = 누름틀 필드 이름 리스트 정보 길이 |
| 8 | byte array[n] | n | 누름틀 필드 이름 리스트 내용.<br>(아래 필드 번호, 길이, 이름이 복수개 반복.(표 33 참조) |
| | | **전체 길이** | **가변 8 + n 바이트** |

#### 표 28. 누름틀 필드 이름 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | word | 2 | 누름틀 필드 번호 |
| 2 | word | 2 | n' = 누름틀 필드 이름 길이 |
| 2 | byte array[n'] | n' | 누름틀 필드 이름 |
| | | **전체 길이** | **가변 4 + n' 바이트** |

### 9. 추가 정보 블록 #2 자료 구조

#### 9.1. 미리보기 이미지 정보

#### 표 29. 미리보기 이미지 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 0x80000001 = 미리보기 이미지 정보 ID |
| 4 | dword | 4 | n = 이미지 내용 길이 |
| 8 | byte array[n] | n | 이미지 내용 (BMP 파일 형식) |
| | | **전체 길이** | **가변 8 + n 바이트** |

#### 9.2. 미리보기 텍스트 정보

#### 표 30. 미리보기 텍스트 정보

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | dword | 4 | 0x80000002 = 미리보기 텍스트 정보 ID |
| 4 | dword | 4 | n = 텍스트 내용 길이 |
| 8 | byte array[n] | n | 텍스트 내용 (hchar 형식) |
| | | **전체 길이** | **가변 8 + n 바이트** |

### 10. 특수 문자 자료 구조

문단 내용 중에 코드가 0-31인 문자들은 특수 용도로 사용된다. 이미 13번 문자는 문단 내용의 끝 식별 기호로 사용된다는 것은 설명한 바 있다. 이외의 특수 문자들은 표나 그림 등, 일반 문자로 표현할 수 없는 문서 장식 요소를 표현하기 위해서 사용된다. 한글에서 사용되는 특수 문자의 종류를 다음 표에 정리해 두었다.

#### 표 31. 한글의 특수 문자

| 코드 | 설명 | 문단 리스트 |
|------|------|------------|
| 0-4 | 예약 | |
| 5 | 필드 코드 (덧말, 계산식, 환경정보, 누름틀) | |
| 6 | 책갈피 | |
| 7 | 날짜 형식 | |
| 8 | 날짜 코드 | |
| 9 | 탭 | |
| 10 | 표/텍스트박스/수식/버튼/하이퍼텍스트 | √ |
| 11 | 그림 | √ |
| 12 | 예약 | |
| 13 | 문단 끝 | |
| 14 | 선 | |
| 15 | 숨은설명 | √ |
| 16 | 머리말/꼬리말 | √ |
| 17 | 각주/미주 | √ |
| 18 | 번호 코드 넣기 | |
| 19 | 번호바꾸기 - 새번호로시작 | |
| 20 | 쪽번호달기 | |
| 21 | 홀수쪽시작/감추기 | |
| 22 | 메일머지 표식 | |
| 23 | 글자겹침 | |
| 24 | 하이픈 | |
| 25 | 제목/표/그림차례 표식 | |
| 26 | 찾아보기 표식 | |
| 27 | 예약 | |
| 28 | 개요 모양/번호 | |
| 29 | 상호참조 | |
| 30 | 묶음빈칸 | |
| 31 | 고정폭빈칸 | |

문서 파일에서 문단 내용을 읽다가 특수 문자를 발견하면, 문서를 읽는 쪽에서는 그 종류에 따라 읽어들이거나 건너 뛰어 다음 데이터의 시작 위치까지 파일 포인터를 옮기기 위한 적절한 처리를 수행해야 한다. 특수 문자 가운데는 또 다른 문단 리스트를 포함하는 경우도 있기 때문에, 특수 문자를 일반 문자처럼 처리하면 문서 파일을 정상적으로 읽을 수 없다.

실제 문단 내의 모든 문자를 살펴보지 않아도, 그 문단에 특수 문자가 포함되어 있는지 없는지는 문단 정보만 읽어보고도 알 수 있다. 문단 정보의 '특수 문자 플래그'이 0이면 그 문단에는 특수 문자가 없는 것을 뜻하며, 이외의 경우에는 해당하는 비트가 나타내는 특수 문자가 존재함을 뜻한다.

표에서 '문단 리스트' 항목에 '√' 표시가 된 것은 문단 리스트를 포함하는 특수 문자를 뜻한다.

문서를 읽다가 현재 사용되지 않는 예약된 특수 문자 코드를 만났을 때는, 이후의 상위 버전과의 호환성을 위해 적절한 크기를 건너뛰어야 한다. 건너뛸 정보의 크기는 다음과 같은 규약에 따라 알 수 있다.

#### 표 32. 예약 특수 문자 형식

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|---------------|------|
| 0 | hchar | 2 | 특수 문자 코드 |
| 2 | dword | 4 | 정보 길이 (n) |
| 6 | hchar | 2 | 특수 문자 코드 |
| 8 | byte array[n] | n | 정보 |
| | | **전체 길이** | **가변 8 + n 바이트** |

#### 10.1. 필드 코드 (5)

필드 코드는 계산식과 문서마당 정보 등을 나타내기 위해 한글 96에 추가된 특수 문자이며, 범용의 특수 문자이므로, 한글 96에서 사용되는 것 이외에도 앞으로 다양한 용도로 쓰일 수 있다.

필드 코드는 임의 길이의 세 개의 hchar 형 문자열과, 한 개의 바이너리 데이터를 가지고 있으며, 필드 코드의 종류에 따라 이 정보들이 고유한 의미로 해석된다.

필드 코드는 한글 96 이전에 예약된 특수 문자를 정의하여 사용하고 있으므로 기본적인 형식은 예약된 특수 문자를 표현하는 규약에 따라 아래와 같다.

#### 표 33. 필드 코드

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 5이다. |
| 2 | dword | 정보 길이 | n : 필드 코드 세부 정보 길이 |
| 6 | hchar | 특수 문자 코드 | 늘 5이다. |
| 8 | byte array[n] | 정보 내용 | 필드 코드 세부 정보 내용 |
| | | **전체 길이** | **가변 8 + n 바이트** |

필드 코드 세부 정보는 아래와 같은 형식으로 저장된다.

**필드 코드 세부 정보**: 필드 코드 세부 정보 헤더 (46 바이트) → 문자열 #1 (n 바이트, 생략 가능) → 문자열 #2 (n 바이트, 생략 가능) → 문자열 #3 (n 바이트, 생략 가능) → 바이너리 데이터 (n 바이트, 생략 가능)

#### 표 34. 필드 코드 세부 정보 헤더

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte array[2] | 종류 | 2/0 = 계산식<br>3/0 = 문서요약<br>3/1 = 개인정보<br>3/2 = 만든 날짜<br>4/0 = 누름틀 |
| 2 | byte array[4] | 예약 | |
| 6 | word | 위치 정보 | 0 = 끝 코드, 1 = 시작 코드 |
| 8 | byte array[22] | 예약 | |
| 30 | dword | 문자열 #1 길이 | hchar문자열 데이터 #1의 길이 - (필드이름)'\0' 포함 |
| 34 | dword | 문자열 #2 길이 | hchar문자열 데이터 #2의 길이 - 입력란안내문 |
| 38 | dword | 문자열 #3 길이 | hchar문자열 데이터 #3의 길이 - 상황선도움말 |
| 42 | dword | 바이너리 데이터 길이 | 임의 형식의 바이너리 데이터 길이 |
| 46 | byte array[n] | 데이터 | n = 문자열#1의 길이 +문자열#2의 길이 +문자열#2의 길이 + 바이너리 데이터의 길이 |
| | | **전체 길이** | **가변 46 + n 바이트** |

현재의 한글 96에서 사용되는 필드 코드는 인용 부호처럼, 본문 중의 내용을 쌍으로 묶은 형태로 사용된다. 위 표에서 위치 정보는 해당하는 필드 코드가 시작인지 끝인지 그 종류를 나타내는 데 사용된다.

- **offset 2**: word 옵션 bit flag 3번째(value 4) : offset 4에 나오는 스타일의 글자모양 사용. 나머지는 정의되어 있으나 구현되어 있지 않음
- **offset 4**: word : 스타일 번호

##### 10.1.1. 계산식 (한글 96에 추가)

내장 시트 기능에 사용되는 계산식을 표현하는 데 사용된다. 문자열 #3에 계산식이 저장되며, 계산 결과는 문자열 #2에 저장된다. 나머지 정보는 사용되지 않는다. 실제 한글에서 계산을 수행하면 필드 코드가 둘러싼 내용이 계산 결과로 치환된다.

##### 10.1.2. 문서요약 (한글 96에 추가)

'문서마당 정보' 대화상자의 '문서요약' 탭을 이용해 입력한 정보이다. 문자열 #3에 종류를 나타내는 다음과 같은 예약어가 저장되며, 해당하는 정보가 문자열 #2에 저장된다. 실제 한글에서 이 코드를 넣을 때 필드 코드가 둘러싼 내용이 문서 요약의 해당 항목으로 치환된다.

- **title**: 제목
- **subject**: 주제
- **author**: 지은이
- **keywords**: 키워드
- **createtime**: 날짜
- **comment**: 기타

##### 10.1.3. 개인정보 (한글 96에 추가)

'문서마당 정보' 대화상자의 '개인정보' 탭을 이용해 입력한 정보이다. 문자열 #3에 종류를 나타내는 다음과 같은 예약어가 저장되며, 해당하는 정보가 문자열 #2에 저장된다. 실제 한글에서 이 코드를 넣을 때 필드 코드가 둘러싼 내용이 환경 설정에서 입력해 둔 개인 정보의 해당 항목으로 치환된다.

| 예약어 | 의미 | 예약어 | 의미 |
|--------|------|--------|------|
| User | 사용자 이름 | E-mail | 전자 우편 주소 |
| Company | 회사명 | Zipcode(home) | 우편번호(집) |
| Position | 직책명 | Phone(home) | 전화번호(집) |
| Division | 부서명 | Address(home) | 주소(집) |
| Fax | 팩스번호 | Zipcode(office) | 우편번호(회사) |
| Pager | 호출기번호 | Phone(office) | 전화번호(회사) |
| BBSID | 통신 아이디 | Address(office) | 주소(회사) |
| UserKey0-9 | 사용자 정의 0-9 | | |

##### 10.1.4. 만든 날짜 (한글 96에 추가)

'문서마당 정보' 대화상자의 '만든날짜' 탭을 이용해 입력한 정보이다. 문자열 #3에 날짜 형식을 나타내는 문자열이 저장된다. 형식은 특수 문자 7번에서 입력하는 것과 동일하며, 해당하는 형식에 맞춰 만들어진 날짜가 문자열 #2에 저장된다. 실제 한글에서 이 코드를 넣을 때 필드 코드가 둘러싼 내용이 날짜 정보로 치환된다.

##### 10.1.5. 누름틀

'문서마당 정보' 대화상자의 '누름틀' 탭을 이용해 입력한 정보이다. 문자열 #3에 상황선에 표시할 도움말, 문자열 #2에 입력할 내용의 안내문이 저장되며, 바이너리 데이터에 다음과 같은 내용이 저장된다.

#### 표 35. 누름틀 바이너리 데이터

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 기타 플래그 | bit 0: 사용자가 내용을 입력하지 않은 초기 상태인지 여부<br>0 = 내용을 입력한 상태<br>1 = 내용을 입력하지 않은 초기 상태<br>bit 1 - 31 = 예약 |
| 4 | word | 필드 번호 | 추가 정보 블록에 저장되어 있는 필드 이름의 필드 번호 |
| 6 | byte array[26] | 예약 | |
| | | **전체 길이** | **32** |

#### 10.2. 책갈피 (6)

#### 표 36. 책갈피

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 6이다. |
| 2 | dword | 자료 구조 길이 | 34 |
| 6 | hchar | 특수 문자 코드 | 늘 6이다. |
| 8 | hchar array[16] | 책갈피 이름 | |
| 40 | word | 책갈피 종류 | 0 = 일반, 1 = 블록 책갈피 시작, 2 = 블록 책갈피 끝 |
| | | **전체 길이** | **42** |

책갈피 List는 파일의 앞쪽 정보블럭에 저장된다. [상호참조]의 [참조대상]으로도 이용된다.

#### 10.3. 날짜 형식 (7)

#### 표 37. 날짜 형식

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 7이다. |
| 2 | hchar array[40] | 날짜 형식 | 날짜 형식 대화상자의 사용자 정의 형태로 표현 |
| 82 | hchar | 특수 문자 코드 | 늘 7이다. |
| | | **전체 길이** | **84** |

#### 10.4. 날짜 코드 (8)

#### 표 38. 날짜 코드

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 8이다. |
| 2 | hchar array[40] | 날짜 형식 | 날짜 형식 문자열 |
| 82 | word array[4] | 날짜 | 년, 월, 요일, 일 |
| 90 | word array[2] | 시각 | 시, 분 |
| 94 | hchar | 특수 문자 코드 | 늘 8이다. |
| | | **전체 길이** | **96** |

##### 날짜 코드 형식

| 코드 | 의미 | 코드 | 의미 |
|------|------|------|------|
| 0 | 자릿수 메움 | ! | 두 자리 년도 |
| 1 | 해(년), 네 자리 | * | 달(월), 영문 |
| 2 | 달(월), 숫자 | @ | 달(월), 영문 약어 |
| 3 | 날짜, 숫자 | # | 날짜, 영문 |
| 6 | 요일, 한글 | ^ | 요일, 영문 약어 |
| ~6 | 요일, 한자 | _ | 요일, 영문 |

##### 시간 코드 형식

| 코드 | 의미 | 코드 | 의미 |
|------|------|------|------|
| 4 | 시, 12시간제 | $ | 시, 24시간제 |
| 5 | 분 | % | 분 |
| 7 | 오전/오후 | & | a.m/p.m |
| ~7 | 午前/午後 | + | A.M/P.M |

**추가정보**:
- 위의 숫자 앞에 0(영)을 덧 붙이면 두자리 이상의 값을 나타내야 할 곳에 자리 수가 모자라는 값이 나오면 0(영)으로 메웁니다.
- 코드로 인식하지 않고 특정한 글자를 넣으려면 '\' 다음에 씁니다.
- (*) 더 자세한 것은 Help 참조

#### 10.5. 탭 (9)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 9이다. |
| 2 | hunit | 탭 문자 폭 | |
| 4 | word | 점 끌기 여부 | |
| 6 | hchar | 특수 문자 코드 | 늘 9이다. |
| 전체 길이 | | 8 | |

**표 39. 탭**

#### 10.6. 표/텍스트박스/수식/버튼/하이퍼텍스트 (10)

표, 텍스트 박스, 수식, 버튼, 하이퍼텍스트는 공통점이 많기 때문에 동일한 자료 구조를 사용하는데, 다음과 같은 구조로 되어 있다.

**구조**: 식별 정보 (8 바이트) → 표 정보 (84 바이트) → 셀 정보 (27 바이트×셀 개수) → 각 셀의 문단 리스트들 (셀 개수만큼) → 캡션 문단 리스트

##### 표 식별 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 10이다. |
| 2 | dword | 예약 | |
| 6 | hchar | 특수 문자 코드 | 늘 10이다. |
| 전체 길이 | | 8 | |

**표 41. 표 식별 정보**

##### 표 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte array[8] | 예약 | |
| 8 | byte | 기준 위치 | 0 - 3 (글자, 문단, 페이지, 종이) |
| 9 | byte | 그림 피함 | 0 - 2 (자리차지, 투명, 어울림) |
| 10 | shunit | 가로 위치 | -1=왼쪽, -2=오른쪽, -3=가운데, 이외=임의 |
| 12 | shunit | 세로 위치 | -1=위, -2=아래, -3=가운데, 이외=임의 |
| 14 | word | 기타 옵션 | bit 0 - 1 = 예약<br>bit 2 = 수식 크기를 문단 폭에 맞출지 여부<br>bit 3 = 예약<br>bit 4 = [하이퍼텍스트]인지 여부<br>bit 5 - 15 = 예약 |
| 16 | hchar | 특수 문자 코드 | 늘 10이다. |
| 18 | hunit array[3][4] | 여백 | [0-2][] = 바깥/안/셀 여백<br>[][0-3] = 왼쪽/오른쪽/위/아래 여백<br>※ ex) [1][3] = 안여백-아래여백 |
| 42 | hunit array[2] | 박스 크기 | 가로, 세로 |
| 46 | hunit array[3] | 캡션 크기 | 가로, 세로, 길이 |
| 52 | hunit array[2] | 전체 크기 | 박스 크기 + 캡션 + 여백 |
| 56 | byte array[4] | 예약 | |
| 60 | byte | 줄간격 보호 | 0 = 보호하지 않음, 1 = 보호함 |
| 61 | byte | 예약 | |
| 62 | hunit array[2] | 박스 위치 | 실제 계산된 결과 박스의 위치. 가로, 세로. |
| 66 | byte array[4] | 예약 | |
| 70 | word | 캡션 위치 | 0 - 7, 메뉴 순서 대로 |
| 72 | word | 박스 번호 | 0부터 시작해 순서대로 매긴 일련 번호 |
| 74 | byte array[2] | 예약 | |
| 76 | word | 표 ID | 차트 연결 표 식별ID/BaseLine:수식일때. (1800 DPI) |
| 78 | word | 박스 종류 | 0=표, 1=텍스트박스, 2=수식, 3=버튼 |
| 80 | word | 셀 개수 | 표일 때는 셀의 개수, 이외는 늘 1이다. (수식도 1) |
| 82 | word | 보호 | 표의 크기가 변하는 것을 막을지 여부 |
| 전체 길이 | | 84 | |

**표 40. 표 정보**

> **참고**: 하이퍼텍스트의 경우에는 '박스 종류'가 버튼으로 되어 있으며, '기타 옵션'의 하이퍼텍스트 비트로 판별한다. 이 경우에는 추가 정보 블록에 하이퍼텍스트에 대한 추가 정보가 저장된다. 자세한 것은 '추가 정보 블록 자료 구조'를 참조하기 바란다. (추가정보 블록 TagID 3, N x 269)

##### 셀 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte array[2] | 줄, 칸 | 내장 시트 기능을 위한 줄, 칸 일련 번호 (0에서 시작) |
| 2 | word | 셀의 색깔 | |
| 4 | hunit array[2] | 셀 위치 | 표 안에서 셀의 위치 (가로, 세로) |
| 8 | hunit array[2] | 셀 크기 | 셀의 크기 (가로, 세로) |
| 12 | hunit | 텍스트 높이 | 셀 안에 있는 텍스트 내용의 높이 |
| 14 | hunit | 셀 높이 | 사용자가 지정한 셀의 높이.<br>실제 셀의 세로 크기는 '텍스트 높이'와 '셀 높이' 중에서 큰 쪽으로 선택된다. |
| 16 | byte array[2] | 예약 | |
| 18 | byte | 상수 | 늘 1이다. |
| 19 | byte | 가운데로 | 셀 안의 글을 세로로 가운데로 오게 할지 여부 |
| 20 | byte array[4] | 선 종류 | 셀의 선 종류 (왼쪽, 오른쪽, 위, 아래)<br>선 종류: 0 = 없음, 1-4 = 메뉴 순서대로<br>0 : 투명<br>1 : 실선<br>2 : 굵은 실선<br>3 : 점선<br>4 : 2중 실선 |
| 24 | byte | 음영 비율 | 0% - 100% |
| 25 | byte | 대각선 | bit 0,1 : 대각선 방향 (0=없음, 1=\\, 2=/, 3 = X)<br>bit 2 : 한 줄로 입력 Flag - 자동align되지 않음<br>bit 3 : reserved<br>bit 4 : 대각선 merge된 cell인가<br>bit 5 : 대각선 merge된 cell일때 0=가로, 1=세로<br>bit 6,7 : reserved |
| 26 | byte | 보호 | 보호를 위해 셀로 들어갈 수 없도록 할지 여부 |
| 전체 길이 | | 27 | |

**표 42. 셀 정보**

> **참고**: 대각선 merge cell은 2001년 6월 추가됨

#### 10.7. 그림 (11)

**구조**: 식별 정보 (8 바이트) → 그림 정보 (348 + n 바이트) → 캡션 문단 리스트

##### 그림 식별 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 11이다. |
| 2 | dword | 예약 | |
| 6 | hchar | 특수 문자 코드 | 늘 11이다. |
| 전체 길이 | | 8 | |

**표 43. 그림 식별 정보**

##### 그림 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 추가 정보 길이 n | 추가 정보의 길이 (바이트 단위) |
| 4 | byte array[4] | 예약 | |
| 8 | byte | 기준 위치 | 0 - 3 (글자, 문단, 페이지, 종이) |
| 9 | byte | 그림 피함 | 0 - 2 (자리차지, 투명, 어울림) |
| 10 | shunit | 가로 위치 | -1=왼쪽, -2=오른쪽, -3=가운데, 이외=임의 |
| 12 | shunit | 세로 위치 | -1=위, -2=아래, -3=가운데, 이외=임의 |
| 14 | word | 기타 옵션 | bit 0 = 테두리 그릴지 여부<br>bit 1 = 그림을 반전시킬지 여부. 0이면 반전.<br>bit 2 = Fit to column<br>bit 3 = 0x8 unknown file<br>bit 4 = 0x10 [hypertext]<br>bit 5 = 0x20 unkown size |
| 16 | hchar | 특수 문자 코드 | 늘 11이다. |
| 18 | shunit array[3][4] | 여백 | [0-2][] = 바깥/안/셀 여백<br>[][0-3] = 왼쪽/오른쪽/위/아래 여백<br>※ [1][2] = 안여백-아래여백<br>※ 그림에서 셀 여백은 사용되지 않음 |
| 42 | hunit array[2] | 박스 크기 | 가로, 세로 |
| 46 | hunit array[3] | 캡션 크기 | 가로, 세로, 길이 |
| 52 | hunit array[2] | 전체 크기 | 박스 크기 + 캡션 + 여백 |
| 56 | byte array[4] | 예약 | |
| 60 | byte | 줄간격 보호 | 0 = 보호하지 않음, 1 = 보호함 |
| 61 | byte | 예약 | |
| 62 | hunit array[2] | 박스 위치 | 실제 계산된 결과 박스의 위치. 가로, 세로. |
| 66 | byte array[4] | 예약 | |
| 70 | word | 캡션 위치 | 0 - 7, 메뉴 순서 |
| 72 | word | 박스 번호 | 0부터 시작해 순서대로 매긴 일련 번호 |
| 74 | byte | 그림 종류 | 0 = 외부 파일, 1 = OLE Object,<br>2 = Embedded Image, 3 = Drawing Object |
| 75 | hunit array[2] | 건너뜀 | 그림에서 실제 표시를 시작할 위치 (가로, 세로) |
| 79 | word array[2] | 확대 비율 | 0 = 고정, 이외 = 퍼센트 단위 비율 (가로, 세로) |
| 83 | kchar array[256] | 그림 파일 이름 | 그림 종류가 0, 1, 2일 때만 사용됨. |
| 339 | byte | 밝기 | 워터마크: 그림의 밝기 (-100 - 100) |
| 340 | byte | 명암 | 워터마크: 그림의 명암 (-100 - 100) |
| 341 | byte | 그림효과 | 워터마크: 0 = 원래 그림으로<br>1 = 그레이 스케일<br>2 = 흑백으로 |
| 342 | byte | 그림보호 | 가 되어 있는 지의 여부 |
| 343 | byte array[5] | 예약 | |
| 348 | byte array[n] | 추가 정보 | 그림 종류가 3(Drawing Object)일 때만 사용됨.<br>그 외는 하이퍼텍스트 정보 (11.1 참고) |
| 전체 길이 | | 가변 | 348 + n 바이트 |

**표 44. 그림 정보**

##### 워터마크 속성

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | char | 밝기 | 그림의 밝기 (-100 - 100) |
| 1 | char | 명암 | 그림의 명암 (-100 - 100) |
| 2 | char | 그림 효과 | 0 = 원래 그림으로<br>1 = 그레이 스케일<br>2 = 흑백으로 |
| 전체 길이 | | 3 | |

**표 45. 워터마크 속성**

> **참고**: 
> - 한글에 내장된 그림 그리기 기능으로 그려진 개체(그림 종류 3)일 때는 실제 데이터는 추가 정보에 저장된다. 자세한 것은 '그리기 개체 자료 구조'를 참조하기 바란다.
> - 그리기 개체가 아닐 때는 하이퍼 텍스트 정보가 포함되어 있다. 추가 정보 내용 중 처음 4byte(dword)를 읽어서 그 값이 0x269이면 하이퍼 텍스트 정보인 것으로 간주한다.

#### 10.8. 선 (14)

**구조**: 식별 정보 (8 바이트) → 선 정보 (84 바이트)

##### 선 식별 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 14이다. |
| 2 | dword | 예약 | |
| 6 | hchar | 특수 문자 코드 | 늘 14이다. |
| 전체 길이 | | 8 | |

**표 46. 선 식별 정보**

##### 선 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte array[8] | 예약 | |
| 8 | byte | 기준 위치 | 0 - 3 (글자, 문단, 페이지, 종이) |
| 9 | byte | 그림 피함 | 늘 1이다. |
| 10 | hunit | 가로 위치 | 선을 대각선으로 하는 사각형의 시작점 x좌표 |
| 12 | hunit | 세로 위치 | 선을 대각선으로 하는 사각형의 시작점 y좌표 |
| 14 | byte array[2] | 예약 | |
| 16 | hchar | 특수 문자 코드 | 늘 14이다. |
| 18 | byte array[24] | 예약 | |
| 42 | hunit array[2] | 박스 크기 | 선을 대각선으로 하는 사각형의 가로, 세로 크기 |
| 46 | byte array[14] | 예약 | |
| 60 | byte | 줄간격 보호 | 0 = 보호하지 않음, 1 = 보호함 |
| 61 | byte array[9] | 예약 | |
| 70 | hunit array[4] | 선 위치 | (시작점 x,y) (끝점 x,y) 좌표 |
| 78 | hunit | 선 굵기 | |
| 80 | word | 음영 비율 | |
| 82 | word | 색깔 | |
| 전체 길이 | | 84 | |

**표 47. 선 정보**

#### 10.9. 숨은설명 (15)

**구조**: 식별 정보 (8 바이트) → 예약 (8 바이트) → 문단 리스트

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 15이다. |
| 2 | dword | 예약 | |
| 6 | hchar | 특수 문자 코드 | 늘 15이다. |
| 전체 길이 | | 8 | |

**표 48. 식별 정보**

#### 10.10. 머리말/꼬리말 (16)

**구조**: 식별 정보 (8 바이트) → 머리말/꼬리말 정보 (10 바이트) → 문단 리스트

##### 식별 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 16이다. |
| 2 | dword | 예약 | |
| 6 | hchar | 특수 문자 코드 | 늘 16이다. |
| 전체 길이 | | 8 | |

**표 49. 식별 정보**

##### 머리말/꼬리말 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte array[8] | 예약 | |
| 8 | byte | 구분 | 0 = 머리말, 1 = 꼬리말 |
| 9 | byte | 종류 | 0 = 양쪽면, 1 = 짝수면, 2 = 홀수면 |
| 전체 길이 | | 10 | |

**표 50. 머리말/꼬리말 정보**

#### 10.11. 각주/미주 (17)

**구조**: 식별 정보 (8 바이트) → 각주/미주 정보 (14 바이트) → 문단 리스트

##### 식별 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 17이다. |
| 2 | dword | 예약 | |
| 6 | hchar | 특수 문자 코드 | 늘 17이다. |
| 전체 길이 | | 8 | |

**표 51. 식별 정보**

##### 각주/미주 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | byte array[8] | 예약 | |
| 8 | word | 번호 | 각주/미주 번호. 0부터 시작. |
| 10 | word | 종류 | 0 = 각주, 1 = 미주 |
| 12 | hunit | 각주 문단 너비 | 각주를 정렬할 당시의 단(본문) 너비 |
| 전체 길이 | | 14 | |

**표 52. 각주/미주 정보**

#### 10.12. 번호 코드 넣기 (18)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 18이다. |
| 2 | word | 종류 | 0=쪽, 1=각주, 2=미주, 3=그림, 4=표, 5=수식 번호 |
| 4 | word | 번호값 | |
| 6 | hchar | 특수 문자 코드 | 늘 18이다. |
| 전체 길이 | | 8 | |

**표 53. 번호 넣기**

#### 10.13. 새 번호로 시작 (번호 바꾸기) (19)

새로 시작할 번호를 지정한다. 번호 코드의 값들이 이 번호를 시작으로 하나씩 증가한다.

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 19이다. |
| 2 | word | 종류 | 0=쪽, 1=각주, 2=미주, 3=그림, 4=표, 5=수식 번호 |
| 4 | word | 새 번호 | |
| 6 | hchar | 특수 문자 코드 | 늘 19이다. |
| 전체 길이 | | 8 | |

**표 54. 번호 바꾸기**

#### 10.14. 쪽번호달기 (20)

한글 97 메뉴의 '모양 - 쪽 번호 매기기'로 넣은 특수 문자이다. (쪽에 쪽번호 달기)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 20이다. |
| 2 | word | 위치 | 0 - 8 |
| 4 | word | 모양 | 0 = arabic, 1 = capital roman, 2 = small roman<br>3-5 = 0-2와 같은 모양에 '- ## -' 형태로 출력 |
| 6 | hchar | 특수 문자 코드 | 늘 20이다. |
| 전체 길이 | | 8 | |

**표 55. 쪽번호달기**

#### 10.15. 홀수쪽시작/감추기 (21)

한글 96 메뉴의 '모양 - 새 번호로 시작 - 항상 홀수쪽으로' 또는 '모양 - 감추기'로 넣은 특수 문자이다.

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 21이다. |
| 2 | word | 종류 | 0 = 홀수로 시작, 1 = 감춤 |
| 4 | word | 감출 대상 | '종류'가 1일 때만 의미가 있다.<br>bit 0 = 머리말 감춤<br>bit 1 = 꼬리말 감춤<br>bit 2 = 쪽번호 감춤<br>bit 3 = 테두리 감춤<br>bit 4 - 15 = 예약 |
| 6 | hchar | 특수 문자 코드 | 늘 21이다. |
| 전체 길이 | | 8 | |

**표 56. 홀수쪽시작/감추기**

#### 10.16. 메일머지 표시 (22)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 22이다. |
| 2 | kchar array[20] | 필드 이름 | 아스키 문자열로 표현된다. |
| 22 | hchar | 특수 문자 코드 | 늘 22이다. |
| 전체 길이 | | 24 | |

**표 57. 메일머지 표시**

#### 10.17. 글자겹침 (23)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 23이다. |
| 2 | hchar array[3] | 겹칠 글자 | 최대 3자까지 가능. 남는 부분은 0으로 채움. |
| 8 | hchar | 특수 문자 코드 | 늘 23이다. |
| 전체 길이 | | 10 | |

**표 58. 글자겹침**

#### 10.18. 하이픈 (24)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 24이다. |
| 2 | hunit | 너비 | 하이픈의 너비 |
| 4 | hchar | 특수 문자 코드 | 늘 24이다. |
| 전체 길이 | | 6 | |

**표 59. 하이픈**

#### 10.19. 제목/표/그림차례 표시 (25)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 25이다. |
| 2 | hunit | 종류 | 0 = 제목차례, 1 = 표차례, 2 = 그림차례 |
| 4 | hchar | 특수 문자 코드 | 늘 25이다. |
| 전체 길이 | | 6 | |

**표 60. 제목/표/그림차례 표시**

#### 10.20. 찾아보기 표시 (26)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 26이다. |
| 2 | hchar array[60] | 첫 번째 키워드 | |
| 122 | hchar array[60] | 두 번째 키워드 | |
| 242 | wordr | 페이지 번호 | Page Num |
| 244 | hchar | 특수 문자 코드 | 늘 26이다. |
| 전체 길이 | | 26 | |

**표 61. 찾아보기 표시**

#### 10.21. 개요 모양/번호 (28)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 28이다. |
| 2 | word | 종류 | 0 = 개요 모양, 1 = 개요 번호 |
| 4 | byte | 형태 | 0 = 사용자 정의 개요<br>1-5 = 한글에 정의된 개요 (메뉴 순서대로)<br>128 = 사용자 정의 개요 및 불릿<br>129-132 = 한글에 정의된 불릿 (메뉴 순서대로)<br>*. 사용자 정의에서 개요 문자만을 사용했다면 0이 되며, 불릿문자를 섞어서 사용하면 128이 된다. |
| 5 | byte | 단계 | 현재 개요 번호의 단계 |
| 6 | word array[7] | 개요 번호 | 각 단계별 개요 번호. 0부터 시작. 불릿일 때는 번호는 매겨지지만, 사용되지는 않는다.<br>예: 1.3.2.4 ☞ 0 2 1 3 0 0 0 |
| 20 | hchar array[7] | 사용자 정의 | 0 - 12 = 메뉴에 나타난 순서대로 개요의 형태<br>128 = 모양 없음<br>이외 = 불릿에 사용될 문자가 저장된다.<br>예: 1. 1.1. 가. ○ -> 12 12 5 0x343b |
| 34 | hchar array[7][2] | 장식 문자 | 사용자 정의 개요 및 불릿일 때 앞, 뒤에 장식할 문자. |
| 62 | hchar | 특수 문자 코드 | 늘 28이다. |
| 전체 길이 | | 64 | |

**표 62. 개요 모양/번호**

#### 10.22. 상호참조 (29)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 29이다. |
| 2 | dword | 자료 구조 길이 | 46 + (참조 내용 길이 n) |
| 6 | hchar | 특수 문자 코드 | 늘 29이다. |
| 8 (0) | byte | 종류 | 0 = 대상, 1 = 참조 이용 |
| 9 (1) | kchar array[37] | 대상 이름 | |
| 46 (38) | word | 참조 종류 | 0=쪽번호, 1=각주번호, 2= 미주번호<br>3=그림번호. 4=표번호, 5=수식번호,<br>6=개요번호<br>참조이용일때 |
| 48 (40) | word | 참조 내용 길이 | 0 = 대상의 경우, n만 필요 |
| 50 (42) | dword | 예약 | |
| 54 (46) | hchar array[n/2] | 참조 내용 | 참조 내용 길이만큼의 내용이 따라 온다. |
| 전체 길이 | | 가변 | 8 + (46 + n*2) 바이트 |

**표 63. 상호참조**

> **참고**:
> - 상호참조코드는 대상(0)과 참조이용(1) 두가지로 사용되는데, 대상의 경우 대상이름만 기록되고 나머지는 기록되지 않는다.
> - 외부파일은 [연결인쇄]에 연결된 파일에서만 참조한다.

#### 10.23. 묶음빈칸 (30)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 30이다. |
| 2 | hchar | 특수 문자 코드 | 늘 30이다. |
| 전체 길이 | | 4 | |

**표 64. 묶음빈칸**

입력시 Ctrl-Space를 누른다.

#### 10.24. 고정폭빈칸 (31)

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hchar | 특수 문자 코드 | 늘 31이다. |
| 2 | hchar | 특수 문자 코드 | 늘 31이다. |
| 전체 길이 | | 4 | |

**표 65. 고정폭빈칸**

입력시 Alt-Space를 누른다.

### 11. 그리기 개체 자료 구조

#### 11.1. 기본 구조

그리기 개체는 여러 개의 개체를 하나의 틀로 묶을 수 있기 때문에, 하나의 그림 코드에 하나 이상의 개체가 존재할 수 있다. 파일상에는 다음과 같은 구조로 저장된다.

**구조**: 그림 정보 (348 바이트) → 틀 헤더 (28 바이트) → (optional 하이퍼텍스트 정보(4 + 617 byte)) → { 개체 정보 1, 개체 정보 2, ... 개체 정보 n }

##### 틀 헤더

'틀 헤더'는 개체를 포함하고 있는 틀의 관리에 필요한 정보를 저장하는 영역으로 자세한 내용은 아래와 같다.

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 헤더 길이 | 자신을 뺀 헤더의 길이. 현재는 24. |
| 4 | dword | zorder | 틀의 zorder 값. 첫 비트가 서 있으면 글 뒤. |
| 8 | dword | 개체 수 | 묶여 있는 개체의 개수. |
| 12 | shunit32 array[4] | 차지 영역 | 선 두께 등을 고려하여 개체가 차지하는 영역을 x, y, xsize, ysize 순서로 나타냄. 좌표는 틀의 원점부터 상대적인 값. |
| 전체 길이 | | 28 | |

**표 66. 틀 헤더**

##### 하이퍼텍스트 정보

"하이퍼텍스트 정보"는 "틀 헤더"의 헤더 길이가 24보다 클 경우 "틀 헤더"에 이어 저장된다.
저장되는 내용은 첫 4byte만 빼면 8.3의 하이퍼텍스트 정보와 같다.

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|--------------|------|
| 0 | dword | 4 | 617 x n = 하이퍼텍스트 정보 길이 |
| 4 | kchar array[256] | 건너뛴 | 파일 이름 현재 파일의 책갈피라면 "\0" |
| 260 | hchar array[16] | 건너뛴 | 책갈피 '[문서의 처음]'은 실제 존재하지는 않지만, 사용되는 책갈피 이름 |
| 292 | byte array[325] | | 매크로 도스용에서 실행할 매크로 |
| 617 | byte | | 종류 0,1 = 한글, 2 = HTML |
| 618 | byte array[3] | | 예약 |
| 전체 길이 | | 가변 | 4 + 617 x n 바이트 |

**표 67. 하이퍼텍스트 정보**

#### 11.2. 저장되는 개체의 순서

그리기 개체는 묶인 순서에 따라 계층 구조를 가진다. 예를 들어 부채꼴과 원을 묶고, 이것을 다시 사각형과 묶었을 때 다음과 같은 계층 구조를 가진다.

**구조**: {사각형 + { 부채꼴 + 원 }}

```
그림 코드
  컨테이너
    컨테이너
```

'컨테이너'는 계층 구조를 나타내기 위해 내부적으로 사용되는, 화면에는 표시되지 않는 개체로서, 묶기를 할 때마다 묶인 개체들의 'parent'로 하나씩 생성된다.

파일상에서의 그리기 개체는 계층 구조 트리에 대한 'preorder traversal' 순서로 저장된다. 따라서 위와 같은 경우라면 다음과 같은 순서로 저장된다.

**순서**: 컨테이너 → 사각형 → 컨테이너 → 부채꼴 → 원

#### 11.3. 개체 정보

틀 헤더에 이어서는 개체의 개수만큼 각각의 개체 정보가 저장된다. 개체 정보는 모든 개체에 공통적으로 적용되는 속성이 저장되는 공통 헤더와, 개체에 따라 서로 다른 정보가 저장되는 세부 정보로 나뉘고, 세부 정보는 다시 두 부분으로 나뉘어 전체적으로 다음과 같은 구조를 가진다.

**구조**: 공통 헤더 (n 바이트) → {optional 글상자 정보(n byte)} → 세부 정보 1의 길이 (4 바이트) → 세부 정보 1의 내용 (n 바이트) → 세부 정보 2의 길이 (4 바이트) → 세부 정보 2의 내용 (n 바이트)

개체의 종류에 따라서 세부 정보는 존재하지 않는 경우도 있다. 세부 정보가 존재하지 않을 때는 세부 정보 1의 길이와 세부 정보 2의 길이가 0이 되므로 8개의 연속된 0으로 표현된다.

그리기 글상자일 경우엔 공통 헤더 뒤에 글상자 정보가 저장된다(글상자 정보는 11.3.6 참조).

#### 11.3.1. 공통 헤더

공통 헤더에는 모든 그리기 속성에 공통적으로 적용되는 정보가 저장된다. 공통 헤더의 길이는 그리기 개체에 적용된 속성에 따라 달라질 수 있는데, 파일상에 다음과 같은 구조로 저장된다.

**구조**: 기본 정보 (48 바이트) → 기본 속성 (44 바이트) → 회전 속성 (32 바이트, 생략 가능) → 그라데이션 속성 (28 바이트, 생략 가능) → 비트맵 패턴 속성 (278 바이트, 생략 가능)

회전, 그라데이션, 비트맵 패턴 속성은 생략 가능하며, 어떤 속성 정보가 존재하는지 생략되었는지는 기본 속성의 기타 옵션으로 알 수 있다. 참고로, 회전 속성은 자료 구조에는 생략 가능하게 되어 있지만, 한글 96에서는 무조건 저장하므로 늘 존재한다.

##### 그리기 개체 공통 헤더

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 헤더 길이 | 자신을 뺀 공통 헤더의 길이. 속성에 따라 가변. |
| 4 | word | 개체 종류 | 0 = 컨테이너<br>1 = 선<br>2 = 사각형<br>3 = 타원<br>4 = 호<br>5 = 다각형<br>6 = 글상자<br>7 = 곡선<br>8 = 변형된 타원 (회전되거나 호로 편집된 타원)<br>9 = 변형된 호 (회전된 호)<br>10 = 선을 그릴 수 있도록 확장된 곡선 |
| 6 | word | 연결 정보 | bit 0 = sibling이 존재하는지 여부<br>bit 1 = child가 존재하는지 여부 |
| 8 | hunit32 array[2] | 상대 위치 | 개체가 속한 그룹의 원점부터 개체 위치 x, y. |
| 16 | hunit32 array[2] | 개체 크기 | 개체의 가로, 세로 크기. |
| 24 | hunit32 array[2] | 절대 위치 | 틀 원점부터 개체 위치 x, y. |
| 32 | shunit32 array[4] | 차지 영역 | 선 두께 등을 고려하여 개체가 차지하는 영역을 x, y, xsize, ysize 순서로 나타냄. 좌표는 개체의 원점부터 상대적인 값. |
| 48 | {기본 속성} | | 기본적인 속성 (44 바이트) |
| 92 | {회전 속성} | | 회전에 관련된 속성 (32 바이트)<br>플래그설정 : 내용이 없는 경우가 존재한다. (헤더의 길이로 Skip할지 판별한다.) |
| 124 | {그라데이션 속성} | | 그라데이션에 관련된 속성 (28 바이트) |
| 152 | {비트맵 패턴 속성} | | 비트맵 패턴에 관련된 속성 (278 바이트) |
| 전체 길이 | | 가변 | 최대 430 바이트 |

**표 68. 그리기 개체 공통 헤더**

##### 그리기 개체 기본 속성

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 48 | dword array[3] | 선 모양 | array[0] = 선의 스타일,<br>array[1] = 끝 부분 화살표 스타일,<br>array[2] = 시작 부분 화살표 스타일 |
| 60 | dword | 선 색깔 | RGB 값 |
| 64 | hunit32 | 선 굵기 | 선의 굵기 |
| 68 | dword | 면 색깔 | RGB 값 |
| 72 | dword | 무늬 종류 | bit 0-23 = 종류<br>bit 24-31 = bit 24: solid(0)/hatched(1)<br>bit 25: bitmap pattern(이미지 fill) |
| 76 | dword | 무늬 색깔 | RGB 값 |
| 80 | hunit32 array[2] | 글상자 여백 | 글상자 가로, 세로 여백. |
| 88 | dword | 기타 옵션 | bit 0 = 둥근 모서리<br>bit 1 = 부채꼴 테두리<br>bit 2 = 반원 모서리<br>bit 3 = 개체의 크기에 맞춰 비트맵 크기 조절<br>bit 4 = 가운데 정렬 (그리기 글상자)<br>bit 5 = 다각형이 닫혀졌는 지의 여부<br>bit 6 - 15 = 예약<br>bit 16 = 그라데이션 속성 존재 여부<br>bit 17 = 회전 속성 존재 여부<br>bit 18 = 비트맵 패턴 속성 존재 여부<br>bit 19 = 그리기를 글상자로 만들 것인지의 여부<br>bit 20 = 워터마크 속성 존재 여부<br>bit 21 - 31 = 예약 |
| 전체 길이 | | 44 | |

**표 69. 그리기 개체 기본 속성**

> **참고**: 한글 97의 점선의 경우 6.0으로 변환시 선의 스타일의 굵기가 2mm이상의 경우 알맞게 수정되어야 비슷한 모양을 유지한다.

##### 그리기 개체 회전 속성

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hunit32 | x좌표 | 회전 중심의 x좌표 |
| 4 | hunit32 | y좌표 | 회전 중심의 y좌표 |
| 8 | hunit32 array[6] | 평행 사변형 | 평행 사변형을 표현하는 세 개의 좌표를 각각 x, y 순으로 저장한다. 사각형을 회전시키고 나서 사이즈를 바꾸면 평행 사변행이 된다. |
| 전체 길이 | | 32 | |

**표 70. 그리기 개체 회전 속성**

##### 그리기 개체 그라데이션 속성

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 시작 색깔 | RGB 값. |
| 4 | dword | 끝 색깔 | RGB 값. |
| 8 | dword | 그라데이션 종류 | 선형, 원형, 원뿔형, 사각형 (1 - 4) |
| 12 | dword | 회전 각도 | 중심축과 이루는 각도 (0 - 360) |
| 16 | dword | 가로 중심 | 가로 중심 (0 - 100%) |
| 20 | dword | 세로 중심 | 세로 중심 (0 - 100%) |
| 24 | dword | 단계 | 밀도 (0 - 100) |
| 전체 길이 | | 28 | |

**표 71. 그리기 개체 그라데이션 속성**

##### 그리기 개체 비트맵 패턴 속성

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | hunit32 array[2] | 시작 위치 | 틀로부터 비트맵 패턴이 출력되는 좌측 상단에 대한 상대 위치 |
| 8 | hunit32 array[2] | 끝 위치 | 틀로부터 비트맵 패턴이 출력되는 우측 하단에 대한 상대 위치 |
| 16 | hchar array[261] | 파일 이름 | 비트맵 패턴의 파일 이름 (조합형) |
| 277 | byte | 옵션 | 0 = 외부 파일<br>2 = embedded image |
| 전체 길이 | | 278 | |

**표 72. 그리기 개체 비트맵 패턴 속성**

##### 워터마크 속성

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | char | 밝기 | 그림의 밝기 (-100 - 100) |
| 1 | char | 명암 | 그림의 명암 (-100 - 100) |
| 2 | char | 그림 효과 | 0 = 원래 그림으로<br>1 = 그레이 스케일<br>2 = 흑백으로 |
| 전체 길이 | | 3 | |

**표 73. 워터마크 속성**

#### 11.3.2. 선 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 4 |
| 4 | dword | 선의 모양 정보 | bit 0 = horizontal flip<br>bit 1 = vertical flip |
| 8 | dword | 정보 2의 길이 | 0 |
| 전체 길이 | | 12 | |

**표 74. 선 세부 정보**

#### 11.3.3. 호 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 4 |
| 4 | dword | 호의 모양 정보 | bit 0 = horizontal flip<br>bit 1 = vertical flip |
| 8 | dword | 정보 2의 길이 | 0 |
| 전체 길이 | | 12 | |

**표 75. 호 세부 정보**

#### 11.3.4. 변형된 호 (회전을 위해 확장된 호)

변형된 호는 추가로 세부정보를 필요로 하지 않는다. 그리기 회전 속성에 있는 평행사변형의 세 점을 가지고 그린다. 첫 점에서 시작해서 끝 점에서 호가 그려지도록 되어있다.

(x1, y1) (x2, y2) (x3, y3) 라면

```
(x1, y1)
       (x2, y2)
(x3, y3)
```

#### 11.3.5. 다각형 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 4 |
| 4 | dword | 점의 개수 | 다각형을 이루는 점의 개수 (np) |
| 8 | dword | 정보 2의 길이 | np×8 |
| 12 | shunit32 array[np×2] | 점의 좌표 | 다각형을 이루는 점들의 좌표 |
| 전체 길이 | | 가변 | 12 + n 바이트 |

**표 77. 다각형 세부 정보**

#### 11.3.6. 글상자 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 0 |
| 4 | dword | 정보 2의 길이 | 문단 리스트 내용의 길이 (n) |
| 8 | byte array[n] | 문단 리스트 내용 | 글상자 내부의 문단 리스트를 바이너리 스트림으로 표현 |
| 전체 길이 | | 가변 | 8 + n 바이트 |

**표 78. 글상자 세부 정보**

#### 11.3.7. 곡선 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 4 |
| 4 | dword | 점의 개수 | 다각형을 이루는 점의 개수 (np) |
| 8 | dword | 정보 2의 길이 | np×8 |
| 12 | shunit32 array[np×2] | 점의 좌표 | 다각형을 이루는 점들의 좌표 |
| 전체 길이 | | 가변 | 12 + n 바이트 |

**표 79. 커브 세부 정보**

#### 11.3.8. 변형된 타원 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 16 |
| 4 | shunit32 array[4] | 호의 좌표 | 타원을 호로 자를 때의 시작점과 끝점의 좌표 |
| 20 | dword | 정보 2의 길이 | 0 |
| 전체 길이 | | 24 | |

**표 80. 변형된 타원 세부 정보**

#### 11.3.9. 확장된 다각형 세부 정보

| 오프셋 | 자료형 | 의미 | 설명 |
|--------|--------|------|------|
| 0 | dword | 정보 1의 길이 | 4 |
| 4 | dword | 점의 개수 | 다각형을 이루는 점의 개수 (np) |
| 8 | dword | 정보 2의 길이 | np×8 |
| 12 | shunit32 array[np×2] | 점의 좌표 | 다각형을 이루는 점들의 좌표 |
| 12+np*8 | char[np] | 선의 속성 | char[t]의 값이 0이라면 point[t]와 point[t+1] 사이가 직선이며, 그렇지 않을 경우는 곡선이다. |
| 전체 길이 | | 가변 | 12 + n 바이트 |

**표 81. 다각형 세부 정보**

#### 11.3.10. 닫혀진 다각형 세부 정보

확장된 다각형의 경우는 n개의 점에 대해 n개의 선속성을 가지고 있지만 실제로는 n-1 개 만이 사용된다. 그러나, 닫혀진 다각형에서는 끝점과 시작점에 대한 선속성이 필요하기 때문에 n개가 다 사용된다.

### 12. OLE 개체 자료 구조

#### 12.1. 기본 구조

문서에 존재하는 OLE 개체들은 특수 문자의 그림 코드에는 이름만 존재하며, 실제 데이터는 모든 OLE 개체를 하나의 스토리지 파일(storage file)에 모아 추가 정보 블록에 저장한다.

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|--------------|------|
| 0 | dword | 4 | 2 = OLE 정보 ID |
| 4 | dword | 4 | OLE 정보 길이 (n) |
| 8 | byte array[n] | n | 파일에 포함되어 있는 OLE 정보 |
| 전체 길이 | | 가변 | 8 + n 바이트 |

**표 82. OLE 정보**

추가 정보 블록의 실제 내용은 다음과 같은 구조를 가진다.

- **OLE 추가 정보 블록 내용**: 인식 정보 (4 바이트) → 스토리지 파일 (n 바이트)
- **인식 정보**: 0xF8995567 (한글 3.0, 3.0a) / 0xF8995568 (한글 3.0b 이상)

한글 3.0에서 저장된 스토리지 파일은 ILockBytes 인터페이스를 구현하여 바이너리 스트림을 바로 파일로 저장한 형식이며, 이런 방식으로 저장할 때 시스템 환경에 따라 문제가 발생하는 경우가 있어서 한글 3.0b 이상에서는 표준 StgCreateDocfile() API를 사용한 일반 스토리지 파일을 그대로 저장하는 방식으로 바뀌었다. 따라서 한글 3.0b 미만의 버전에서 저장된 OLE 정보를 읽기 위해서는 인식 정보를 읽어 그에 따른 적절한 방식을 선택해야 한다.

#### 12.2. 스토리지 파일의 구조

루트 스토리지 아래, 특수 문자의 그림 코드에 지정된 이름과 같은 서브 스토리지가 개체의 개수만큼 존재하며, 여기에 개체의 내용이 저장된다. 개체의 저장에는 표준 OleSave() API를 사용했기 때문에 OleLoad() API로 읽을 수 있다.

한글에서 각 개체 별로 자체적으로 관리하는 정보는 루트 스토리지 아래, 특수 문자의 그림 코드에 지정된 이름과 같고 확장자만 '.inf'로 바뀐 스트림(stream)에 저장된다. 여기에 저장되는 정보의 구조는 다음과 같다.

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|--------------|------|
| 0 | dword | 4 | 가로 크기 (HIMETRIC) |
| 4 | dword | 4 | 세로 크기 (HIMETRIC) |
| 8 | dword | 4 | DVASPECT_CONTENT or DVASPECT_ICON |
| 12 | byte array[116] | 116 | 예약 |
| 전체 길이 | | 24 | |

**표 83. 변형된 타원 세부 정보**

#### 12.3. 차트 정보

OLE 개체가 한글에 내장된 차트일 때는 표와 차트의 연결을 관리하기 위한 추가 정보가 저장된다.

추가 정보는 OLE 개체가 저장되는 서브 스토리지 내부에 'HWPChart.Info'라는 이름의 스트림에 저장되며, 내용은 다음과 같다.

| 오프셋 | 자료형 | 길이 (바이트) | 의미 |
|--------|--------|--------------|------|
| 0 | word | 2 | bit 0 = 표와 연결되었는지 여부 (linked)<br>bit 1-15 = 예약 |
| 2 | word | 2 | 표 ID (tblid) |
| 4 | dword | 4 | bit 0 = 전체 표인지 여부 (entire)<br>bit 1-31 = 예약 |
| 8 | dword | 4 | 시작 셀의 칸 번호 (startcol) |
| 12 | dword | 4 | 시작 셀의 줄 번호 (startrow) |
| 16 | dword | 4 | 끝 셀의 칸 번호 (endcol) |
| 20 | dword | 4 | 끝 셀의 줄 번호 (endrow) |
| 24 | dword | 4 | 표 내용 데이터의 길이 (chsize) |
| 28 | byte array[100] | 100 | 예약 |
| 전체 길이 | | 128 | |

**표 84. 차트 연결 정보**

linked가 0일 때는 표에 연결되지 않은 독립적인 차트를 뜻하며, 이 경우에는 나머지 모든 값이 의미 없다.

tblid는 문서 중의 모든 표에 각각 부여된 유일한 ID이며, 이 ID를 통해 특정한 차트가 어떤 표와 연결되어 있는지 나타낸다.

entire가 1일 때는 이 차트가 표 전체의 데이터와 연결되었음을 뜻한다. 이 경우에는 범위를 나타내는 값이 의미가 없다. entire가 0일 때는 표의 일부분만 차트와 연결되었음을 뜻하며, 범위를 나타내는 값들이 실제 사용자가 차트를 만들 때 셀 블록으로 지정한 범위를 나타낸다.

chsize는 실제 각 셀의 내용이 순차적으로 ASCIIZ 형식으로 연속되어 배열된 데이터의 총 바이트 수를 나타낸다. 실제 데이터 내용은 'HWPChart.Info'가 저장된 동일한 storage에 'HWPChart.Data'라는 이름의 stream으로 저장된다.

한글은 사용자가 차트와 연결된 표의 내용을 바꿨을 때, 이러한 정보들을 토대로 차트를 업데이트할지 여부를 결정한다.

## 변경 사항 이력

**revision 1.2:20141105**
- 구 5.0 내용 삭제
- 회사 주소 정보 수정

**revision 1.1:20110124**
- 저작권 내용 수정
- 내용 중 일부 오타 수정

**revision 1.0:20100701**
- 한글 문서 파일 형식 공개

## 발행 정보

**발행처**: (주) 한글과컴퓨터

**주소**: (우) 463-400 경기도 성남시 분당구 대왕판교로644번길 49 한컴타워 10층

**전화**: (031) 627-7000

**팩스**: (031) 627-7709

**문서 끝**
